<!DOCTYPE html><html lang="zh-CN"><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description"><title>思考，执行，表达！</title><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/normalize/5.0.0/normalize.min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/pure/0.6.0/pure-min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/pure/0.6.0/grids-responsive-min.css"><link rel="stylesheet" type="text/css" href="/css/style.css?v=0.0.0"><link rel="stylesheet" href="//cdn.bootcss.com/font-awesome/4.7.0/css/font-awesome.min.css"><script type="text/javascript" src="//cdn.bootcss.com/jquery/3.1.1/jquery.min.js"></script><link rel="Shortcut Icon" type="image/x-icon" href="/favicon.ico"><link rel="apple-touch-icon" href="/apple-touch-icon.png"><link rel="apple-touch-icon-precomposed" href="/apple-touch-icon.png"><link rel="alternate" type="application/atom+xml" href="/atom.xml"></head><body><div class="body_container"><div id="header"><div class="site-name"><h1 class="hidden">思考，执行，表达！</h1><a id="logo" href="/.">思考，执行，表达！</a><p class="description"></p></div><div id="nav-menu"><a href="/." class="current"><i class="fa fa-home"> 首页</i></a><a href="/archives/"><i class="fa fa-archive"> 归档</i></a><a href="/about/"><i class="fa fa-user"> 关于</i></a><a href="/atom.xml"><i class="fa fa-rss"> 订阅</i></a></div></div><div id="layout" class="pure-g"><div class="pure-u-1 pure-u-md-3-4"><div class="content_container"><div class="post"><h2 class="post-title"><a href="/2015/02/09/proxy.html">语言与模式-07代理模式</a></h2><div class="post-meta">2015-02-09</div><a data-thread-key="2015/02/09/proxy.html" href="/2015/02/09/proxy.html#comments" class="ds-thread-count"></a><div class="post-content"><h1 id="意图"><a href="#意图" class="headerlink" title="意图"></a>意图</h1><p>为其他对象提供一种代理以控制对这个对象的访问。</p>
<p><img src="/assets/designpattern/proxy.jpg" alt=""></p>
<p>#适用性</p>
<p>在需要用比较通用和复杂的对象指针代替简单的指针的时候，使用Proxy模式。下面是一些可以使用Proxy模式常见情况：</p>
<ul>
<li>远程代理（Remote Proxy）为一个对象在不同的地址空间提供局部代表。</li>
<li>虚代理（Virtual Proxy）根据需要创建开销很大的对象。</li>
<li>保护代理（Protection Proxy）控制对原始对象的访问。保护代理用于对象应该有不同 的访问权限的时候。</li>
<li>智能指引（Smart Reference）取代了简单的指针，它在访问对象时执行一些附加操作。 它的典型用途包括：</li>
<li>对指向实际对象的引用计数，这样当该对象没有引用时，可以自动释放它（也称为SmartPointers）。</li>
<li>当第一次引用一个持久对象时，将它装入内存。</li>
<li>在访问一个实际对象前，检查是否已经锁定了它，以确保其他对象不能改变它。</li>
</ul>
<h1 id="Java实现"><a href="#Java实现" class="headerlink" title="Java实现"></a>Java实现</h1><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//工厂接口</span></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">ItemFactory</span></span>&#123;</div><div class="line">     <span class="function"><span class="keyword">public</span> Item <span class="title">getItem</span><span class="params">()</span></span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">//工厂实现,Item就不实现了，随便怎么写都行</span></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ItemFactoryImpl</span> <span class="keyword">implements</span> <span class="title">ItemFactory</span></span>&#123;</div><div class="line">      <span class="function"><span class="keyword">public</span> Item <span class="title">getItem</span><span class="params">()</span></span>&#123;</div><div class="line">          <span class="keyword">return</span> <span class="keyword">new</span> Item();</div><div class="line">      &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">//商店类，就是代理</span></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Shop</span> <span class="keyword">implements</span> <span class="title">ItemFactory</span></span>&#123;</div><div class="line"></div><div class="line">     <span class="keyword">private</span> ItemFactory factory = <span class="keyword">new</span> ItemFactoryImpl();</div><div class="line"></div><div class="line">     <span class="function"><span class="keyword">public</span> Item <span class="title">getItem</span><span class="params">()</span></span>&#123;</div><div class="line">          System.out.println(<span class="string">"附加服务"</span>);</div><div class="line">          <span class="keyword">return</span> factory.getItem();</div><div class="line">     &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">//实际调用</span></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Main</span></span>&#123;</div><div class="line">     <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span></span>&#123;</div><div class="line">          ItemFactory f = <span class="keyword">new</span> Shop();</div><div class="line">          f.getItem();</div><div class="line">     &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></div><p class="readmore"><a href="/2015/02/09/proxy.html">阅读更多</a></p></div><div class="post"><h2 class="post-title"><a href="/2015/02/08/facade.html">语言与模式-06门面模式</a></h2><div class="post-meta">2015-02-08</div><a data-thread-key="2015/02/08/facade.html" href="/2015/02/08/facade.html#comments" class="ds-thread-count"></a><div class="post-content"><h1 id="意图"><a href="#意图" class="headerlink" title="意图"></a>意图</h1><p>为子系统中的一组接口提供一个一致的界面，Facade模式定义了一个高层接口，这个接口使得这一子系统更加容易使用。</p>
<p><img src="/assets/designpattern/facade.jpg" alt=""></p>
<h1 id="适用性"><a href="#适用性" class="headerlink" title="适用性"></a>适用性</h1><ul>
<li>当你要为一个复杂子系统提供一个简单接口时。子系统往往因为不断演化而变得越来越复杂。大多数模式使用时都会产生更多更小的类。这使得子系统更具可重用性，也更容易对子系统进行定制，但这也给那些不需要定制子系统的用户带来一些使用上的困难。Facade可以提供一个简单的缺省视图，这一视图对大多数用户来说已经足够，而那些需要更多的可定制性的用户可以越过Facade层。</li>
<li>客户程序与抽象类的实现部分之间存在着很大的依赖性。引入Facade将这个子系统与客户以及其他的子系统分离，可以提高子系统的独立性和可移植性。</li>
<li>当你需要构建一个层次结构的子系统时，使用门面模式定义子系统中每层的入口点。如果子系统之间是相互依赖的，你可以让它们仅通过Facade进行通讯，从而简化了它们之间的依赖关系。</li>
</ul>
<h1 id="Java实现"><a href="#Java实现" class="headerlink" title="Java实现"></a>Java实现</h1><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Camara</span> </span>&#123;</div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">turnOn</span><span class="params">()</span></span>&#123;</div><div class="line">		System.out.println(<span class="string">"开启摄像头！"</span>);</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">turnOff</span><span class="params">()</span></span>&#123;</div><div class="line">		System.out.println(<span class="string">"关闭摄像头！"</span>);</div><div class="line">	&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Light</span> </span>&#123;</div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">turnOn</span><span class="params">()</span></span>&#123;</div><div class="line">		System.out.println(<span class="string">"开灯！"</span>);</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">turnOff</span><span class="params">()</span></span>&#123;</div><div class="line">		System.out.println(<span class="string">"关灯！"</span>);</div><div class="line">	&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></div><p class="readmore"><a href="/2015/02/08/facade.html">阅读更多</a></p></div><div class="post"><h2 class="post-title"><a href="/2015/02/07/builder.html">语言与模式-05生成器模式</a></h2><div class="post-meta">2015-02-07</div><a data-thread-key="2015/02/07/builder.html" href="/2015/02/07/builder.html#comments" class="ds-thread-count"></a><div class="post-content"><h1 id="意图"><a href="#意图" class="headerlink" title="意图"></a>意图</h1><p>将一个复杂对象的构建与它的表示分离，使得同样的构建过程可以创建不同的表示。</p>
<p><img src="/assets/designpattern/builder.jpg" alt=""></p>
<h1 id="适用性"><a href="#适用性" class="headerlink" title="适用性"></a>适用性</h1><ul>
<li>当创建复杂对象的算法应该独立于该对象的组成部分以及它们的装配方式时。</li>
<li>当构造过程必须允许被构造的对象有不同的表示时。</li>
</ul>
<h1 id="Java实现"><a href="#Java实现" class="headerlink" title="Java实现"></a>Java实现</h1><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// 待构建产品</span></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Starbucks</span> </span>&#123;</div><div class="line">    <span class="keyword">private</span> String size;</div><div class="line">    <span class="keyword">private</span> String drink;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setSize</span><span class="params">(String size)</span> </span>&#123;</div><div class="line">        <span class="keyword">this</span>.size = size;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setDrink</span><span class="params">(String drink)</span> </span>&#123;</div><div class="line">        <span class="keyword">this</span>.drink = drink;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//抽象builder</span></div><div class="line"><span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">StarbucksBuilder</span> </span>&#123;</div><div class="line">    <span class="keyword">protected</span> Starbucks starbucks;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> Starbucks <span class="title">getStarbucks</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> starbucks;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">createStarbucks</span><span class="params">()</span> </span>&#123;</div><div class="line">        starbucks = <span class="keyword">new</span> Starbucks();</div><div class="line">        System.out.println(<span class="string">"a drink is created"</span>);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">buildSize</span><span class="params">()</span></span>;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">buildDrink</span><span class="params">()</span></span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure></div><p class="readmore"><a href="/2015/02/07/builder.html">阅读更多</a></p></div><div class="post"><h2 class="post-title"><a href="/2015/02/06/prototype.html">语言与模式-04原型模式</a></h2><div class="post-meta">2015-02-06</div><a data-thread-key="2015/02/06/prototype.html" href="/2015/02/06/prototype.html#comments" class="ds-thread-count"></a><div class="post-content"><h1 id="意图"><a href="#意图" class="headerlink" title="意图"></a>意图</h1><p>用原型实例指定创建对象的种类，并且通过拷贝这些原型创建新的对象。</p>
<p><img src="/assets/designpattern/prototype.jpg" alt=""></p>
<h1 id="适用性"><a href="#适用性" class="headerlink" title="适用性"></a>适用性</h1><ul>
<li>当要实例化的类是在运行时刻指定时，例如，通过动态装载；或者</li>
<li>为了避免创建一个与产品类层次平行的工厂类层次时；或者</li>
<li>当一个类的实例只能有几个不同状态组合中的一种时。建立相应数目的原型并克隆它们可能比每次用合适的状态手工实例化该类更方便一些。</li>
</ul>
<h1 id="Java实现"><a href="#Java实现" class="headerlink" title="Java实现"></a>Java实现</h1><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//浅拷贝</span></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">A</span> <span class="keyword">implements</span> <span class="title">Cloneable</span></span>&#123;</div><div class="line"></div><div class="line">    <span class="keyword">private</span> String str;</div><div class="line">    <span class="keyword">private</span> B b;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setStr</span><span class="params">(String str)</span></span>&#123;</div><div class="line">        <span class="keyword">this</span>.str = str;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getStr</span><span class="params">()</span></span>&#123;</div><div class="line">        <span class="keyword">return</span> str;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> B <span class="title">getB</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> b;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setB</span><span class="params">(B b)</span> </span>&#123;</div><div class="line">        <span class="keyword">this</span>.b = b;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">protected</span> Object <span class="title">clone</span><span class="params">()</span></span>&#123;</div><div class="line">        A a = <span class="keyword">null</span>;</div><div class="line">        <span class="keyword">try</span> &#123;</div><div class="line">            a = (A) <span class="keyword">super</span>.clone();</div><div class="line">        &#125; <span class="keyword">catch</span> (CloneNotSupportedException e) &#123;</div><div class="line">            e.printStackTrace();</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> a;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</div><div class="line">        A a = <span class="keyword">new</span> A();</div><div class="line">        a.setStr(<span class="string">"Hello"</span>);</div><div class="line">        B b = <span class="keyword">new</span> B();</div><div class="line">        b.setStr(<span class="string">"Hello B"</span>);</div><div class="line">        a.setB(b);</div><div class="line">        System.out.println(<span class="string">"a-str:"</span> + a.getStr());</div><div class="line">        System.out.println(<span class="string">"a-b:"</span> + a.getB().getStr());</div><div class="line">        A ac = <span class="keyword">null</span>;</div><div class="line">        ac = (A) a.clone();</div><div class="line">        System.out.println(<span class="string">"ac-str:"</span> + ac.getStr());</div><div class="line">        System.out.println(<span class="string">"ac-b:"</span> + ac.getB().getStr());</div><div class="line"></div><div class="line">        a.setStr(<span class="string">"Hello A"</span>);</div><div class="line">        b.setStr(<span class="string">"Hello BB"</span>);</div><div class="line">        a.setB(b);</div><div class="line"></div><div class="line">        System.out.println(<span class="string">"a-str:"</span> + a.getStr());</div><div class="line">        System.out.println(<span class="string">"a-b:"</span> + a.getB().getStr());</div><div class="line">        System.out.println(<span class="string">"ac-str:"</span> + ac.getStr());</div><div class="line">        System.out.println(<span class="string">"ac-b:"</span> + ac.getB().getStr());</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></div><p class="readmore"><a href="/2015/02/06/prototype.html">阅读更多</a></p></div><div class="post"><h2 class="post-title"><a href="/2015/02/05/abstract_factory.html">语言与模式-03抽象工厂模式</a></h2><div class="post-meta">2015-02-05</div><a data-thread-key="2015/02/05/abstract_factory.html" href="/2015/02/05/abstract_factory.html#comments" class="ds-thread-count"></a><div class="post-content"><h1 id="意图"><a href="#意图" class="headerlink" title="意图"></a>意图</h1><p>提供一个创建一系列相关或相互依赖对象的接口，而无需指定它们具体的类。</p>
<p><img src="/assets/designpattern/abstract_factory.jpg" alt=""></p>
<h1 id="适用性"><a href="#适用性" class="headerlink" title="适用性"></a>适用性</h1><ul>
<li>一个系统要独立于它的产品的创建、组合和表示时。</li>
<li>一个系统要由多个产品系列中的一个来配置时。</li>
<li>当你要强调一系列相关的产品对象的设计以便进行联合使用时。</li>
<li>当你提供一个产品类库，而只想显示它们的接口而不是实现时。</li>
</ul>
<h1 id="Java实现"><a href="#Java实现" class="headerlink" title="Java实现"></a>Java实现</h1><p>表现在代码层面就是一个工厂可以返回多个不同的实例！</p>
<p>比如:Pig不仅分颜色，还分国家，比如荷兰Pig，新西兰Pig。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">RedPigFactory</span> <span class="keyword">implements</span> <span class="title">PigFactory</span></span>&#123;</div><div class="line">     <span class="function"><span class="keyword">public</span> Pig <span class="title">getNetherlandsPig</span><span class="params">()</span></span>&#123;</div><div class="line">          <span class="keyword">return</span> <span class="keyword">new</span> RedNetherlandsPig();</div><div class="line">     &#125;</div><div class="line"></div><div class="line">     <span class="function"><span class="keyword">public</span> Pig <span class="title">getNewZealandPig</span><span class="params">()</span></span>&#123;</div><div class="line">          <span class="keyword">return</span> <span class="keyword">new</span> RedNewZealandPig();</div><div class="line">     &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></div><p class="readmore"><a href="/2015/02/05/abstract_factory.html">阅读更多</a></p></div><div class="post"><h2 class="post-title"><a href="/2015/02/04/factory.html">语言与模式-02工厂模式</a></h2><div class="post-meta">2015-02-04</div><a data-thread-key="2015/02/04/factory.html" href="/2015/02/04/factory.html#comments" class="ds-thread-count"></a><div class="post-content"><h1 id="意图"><a href="#意图" class="headerlink" title="意图"></a>意图</h1><p>定义一个用于创建对象的接口，让子类决定实例化哪一个类。Factory Method使一个类的实例化延迟到其子类。</p>
<p><img src="/assets/designpattern/factory.jpg" alt=""></p>
<h1 id="适用性"><a href="#适用性" class="headerlink" title="适用性"></a>适用性</h1><ul>
<li>当一个类不知道它所必须创建的对象的类的时候。</li>
<li>当一个类希望由它的子类来指定它所创建的对象的时候。</li>
<li>当类将创建对象的职责委托给多个帮助子类中的某一个，并且你希望将哪一个帮助子类是代理者这一信息局部化的时候。</li>
</ul>
<h1 id="Java实现"><a href="#Java实现" class="headerlink" title="Java实现"></a>Java实现</h1><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">Pig</span></span>&#123;</div><div class="line">     <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span></span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">PigFactory</span></span>&#123;</div><div class="line">     <span class="function"><span class="keyword">public</span> Pig <span class="title">getPig</span><span class="params">()</span></span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">RedPig</span></span>&#123;</div><div class="line">     <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span></span>&#123;</div><div class="line">       System.out.println(<span class="string">"RedPig run"</span>);</div><div class="line">     &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">RedPigFactory</span> <span class="keyword">implements</span> <span class="title">PigFactory</span></span>&#123;</div><div class="line">     <span class="function"><span class="keyword">public</span> Pig <span class="title">getPig</span><span class="params">()</span></span>&#123;</div><div class="line">          <span class="keyword">return</span> <span class="keyword">new</span> RedPig();</div><div class="line">     &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">GreenPig</span></span>&#123;</div><div class="line">     <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span></span>&#123;</div><div class="line">       System.out.println(<span class="string">"GreenPig run"</span>);</div><div class="line">     &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">GreenPigFactory</span> <span class="keyword">implements</span> <span class="title">PigFactory</span></span>&#123;</div><div class="line">     <span class="function"><span class="keyword">public</span> Pig <span class="title">getPig</span><span class="params">()</span></span>&#123;</div><div class="line">          <span class="keyword">return</span> <span class="keyword">new</span> GreenPig();</div><div class="line">     &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></div><p class="readmore"><a href="/2015/02/04/factory.html">阅读更多</a></p></div><div class="post"><h2 class="post-title"><a href="/2015/02/03/singleton.html">Singleton与JMM</a></h2><div class="post-meta">2015-02-03</div><a data-thread-key="2015/02/03/singleton.html" href="/2015/02/03/singleton.html#comments" class="ds-thread-count"></a><div class="post-content"><h1 id="概述"><a href="#概述" class="headerlink" title="概述"></a>概述</h1><p>设计模式是什么？如果要我现在来回答，那我的答案是：<strong>设计模式是对于语言本身缺陷的一种补充！</strong></p>
<p>本系列文章通过对各个设计模式在Java与Clojure之间的实现比较来说明这一点！</p>
<p>关于Clojure相关内容，可以查看<a href="/tag/#clojure">这里</a>!</p>
<p>其实使用Clojure来实现设计模式并不合适！因为Clojure是函数式语言，而设计模式是针对面向对象语言的。但是Clojure能提供近似的解决方案或者根本不需要此设计模式，且Clojure的解决方案更简单！简单到都不好意思叫做模式！</p>
<p>当然我也不是要黑Java，毕竟还要靠Java吃饭！Java作为工业化标准开发还是很不错的，只是表现力不足，模板代码较多而已！但是足够简单，易标准化。这就够了！</p>
<p>废话不多说，开始第一个设计模式！单例模式！</p>
<h1 id="意图"><a href="#意图" class="headerlink" title="意图"></a>意图</h1><p>保证一个类仅有一个实例，并提供一个访问它的全局访问点。</p>
<p><img src="/assets/designpattern/singleton.jpg" alt=""></p>
<h1 id="适用性"><a href="#适用性" class="headerlink" title="适用性"></a>适用性</h1><ul>
<li>当类只能有一个实例而且客户可以从一个众所周知的访问点访问它时。</li>
<li>当这个唯一实例应该是通过子类化可扩展的，并且客户应该无需更改代码就能使用一个扩展的实例时。</li>
</ul>
<h1 id="Java实现"><a href="#Java实现" class="headerlink" title="Java实现"></a>Java实现</h1><p>懒汉式：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Singleton</span></span>&#123;</div><div class="line">       <span class="function"><span class="keyword">private</span> <span class="title">Singleton</span><span class="params">()</span></span>&#123;&#125;</div><div class="line"></div><div class="line">       <span class="function"><span class="keyword">public</span> <span class="keyword">synchronized</span> <span class="keyword">static</span> Singleton <span class="title">getInstance</span><span class="params">()</span></span>&#123;</div><div class="line">           <span class="keyword">if</span>(single==<span class="keyword">null</span>)&#123;</div><div class="line">                single=<span class="keyword">new</span> Singleton();</div><div class="line">           &#125;</div><div class="line">           <span class="keyword">return</span> single;</div><div class="line">       &#125;</div><div class="line"></div><div class="line">      <span class="keyword">private</span> <span class="keyword">static</span> Singleton single;</div><div class="line">&#125;</div></pre></td></tr></table></figure></div><p class="readmore"><a href="/2015/02/03/singleton.html">阅读更多</a></p></div><div class="post"><h2 class="post-title"><a href="/2014/11/28/pigtheme.html">LightTable Theme</a></h2><div class="post-meta">2014-11-28</div><a data-thread-key="2014/11/28/pigtheme.html" href="/2014/11/28/pigtheme.html#comments" class="ds-thread-count"></a><div class="post-content"><h1 id="LightTable-Theme"><a href="#LightTable-Theme" class="headerlink" title="LightTable Theme"></a>LightTable Theme</h1><ul>
<li>自用LightTable代码高亮配色,修改自solarized!</li></div><p class="readmore"><a href="/2014/11/28/pigtheme.html">阅读更多</a></p></div><div class="post"><h2 class="post-title"><a href="/2014/10/02/clojure_spels.html">Clojure进阶:使用Clojure编写文字冒险游戏</a></h2><div class="post-meta">2014-10-02</div><a data-thread-key="2014/10/02/clojure_spels.html" href="/2014/10/02/clojure_spels.html#comments" class="ds-thread-count"></a><div class="post-content"><p>本文翻译自:<a href="http://www.lisperati.com/clojure-spels/casting.html">Casting SPELs in Clojure</a></p>
<p><img src="/assets/clojure/cs_01.jpg" alt=""></p>
<h1 id="准备"><a href="#准备" class="headerlink" title="准备"></a>准备</h1><p>任何学过Lisp的人都会说Lisp和其它语言有很大的不同.它有很多不可思议的地方.本文将告诉你它有哪些独特之处!</p>
<p>本文适用于Clojure,它是一个运行在JVM上的Lisp方言.Clojure的API和语法和<br>Common Lisp很类似,但是还是有足够多的区别,需要单独为其写个教程.</p>
<p>在大部分情况下,我们会说Lisp而不是Clojure,因为大部分的概念在Lisp中是通用的.我们会指出Clojure特有的内容.</p>
<p><img src="/assets/clojure/cs_02.jpg" alt=""></p>
<p>Clojure是运行在JVM之上的,所以你需要先安装JVM.如果你是MAC机,那么Java已经被安装过了.如果是Linux或者Windows系统,你需要到<a href="http://java.sun.com/javase/downloads/index.jsp">Oracle Java官网</a>下载对应版本的Java.</p>
<p>而Clojure,你可以从它的<a href="http://clojure.org/">官网</a>获得最新版本.下载完成后,你只需要解压缩,打开命令行,切换到解压缩目录,输入:</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">java -jar clojure.jar</div></pre></td></tr></table></figure>
<p>如果没有问题,那么你将会看到Clojure输出提示</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">Clojure 1.6.0</div><div class="line">user=&gt;</div></pre></td></tr></table></figure>
<p>教程中有很多Clojure代码片段,类似下面的样子:</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">'(these kinds of boxes)</div></pre></td></tr></table></figure>
<p>你只需要将这些代码片段拷贝到Clojure REPL中运行就可以了!当你学习完此教程,你将会有一个你自己的文字冒险游戏了!</p></div><p class="readmore"><a href="/2014/10/02/clojure_spels.html">阅读更多</a></p></div><div class="post"><h2 class="post-title"><a href="/2014/10/01/dsl.html">Clojure进阶:使用Clojure构建DSL</a></h2><div class="post-meta">2014-10-01</div><a data-thread-key="2014/10/01/dsl.html" href="/2014/10/01/dsl.html#comments" class="ds-thread-count"></a><div class="post-content"><p>翻译自<a href="http://clojure-doc.org/articles/tutorials/growing_a_dsl_with_clojure.html">Growing a DSL with Clojure</a>.主要讲解如何使用</p>
<p>Clojure来创建一个简单的DSL.包括如下知识点:</p>
<ul>
<li>多重方法(Multimethods)</li>
<li>继承(Hierarchies)</li>
<li>元编程及”代码即数据”哲学(Metaprogramming and the “Code as data” philosophy)</li>
</ul>
<p>Lisp及其方言(比如Clojure)可以很方便的创建DSL并能和源语言无缝的集成.</p>
<p>Lisp界鼓吹的优点中，提到最多的可能就是:数据即代码，代码即数据了。在此文中我们将依此特性来定义一个DSL。</p>
<p>我们将渐进式的开发这个DSL，不断的加入Clojure的特性和抽象。</p>
<h1 id="任务"><a href="#任务" class="headerlink" title="任务"></a>任务</h1><p>我们的目标是定义一个可以生成各种脚本语言的DSL.而且DSL代码看起来和普通的Clojure代码没有区别。</p>
<p>例如,我们使用Clojure形式(form)来生成Bash脚本或者Windows批处理脚本:</p>
<p>输入(Clojure形式):</p>
<figure class="highlight clojure"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">(<span class="name"><span class="builtin-name">if</span></span> (<span class="name"><span class="builtin-name">=</span></span> <span class="number">1</span> <span class="number">2</span>)</div><div class="line">  (<span class="name">println</span> <span class="string">"a"</span>)</div><div class="line">  (<span class="name">println</span> <span class="string">"b"</span>))</div></pre></td></tr></table></figure>
<p>输出(Bash脚本):</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">if</span> [ 1 <span class="_">-eq</span> 2 ]; <span class="keyword">then</span></div><div class="line">  <span class="built_in">echo</span> <span class="string">"a"</span></div><div class="line"><span class="keyword">else</span></div><div class="line">  <span class="built_in">echo</span> <span class="string">"b"</span></div><div class="line"><span class="keyword">fi</span></div></pre></td></tr></table></figure>
<p>输出(Windows批处理):</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">IF 1==2 (</div><div class="line">  ECHO a</div><div class="line">) ELSE (</div><div class="line">  ECHO b</div><div class="line">)</div></pre></td></tr></table></figure></div><p class="readmore"><a href="/2014/10/01/dsl.html">阅读更多</a></p></div><nav class="page-navigator"><a class="extend prev" rel="prev" href="/page/6/">上一页</a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/5/">5</a><a class="page-number" href="/page/6/">6</a><span class="page-number current">7</span><a class="page-number" href="/page/8/">8</a><a class="page-number" href="/page/9/">9</a><span class="space">&hellip;</span><a class="page-number" href="/page/12/">12</a><a class="extend next" rel="next" href="/page/8/">下一页</a></nav></div></div><div class="pure-u-1-4 hidden_mid_and_down"><div id="sidebar"><div class="widget"><form action="//www.google.com/search" method="get" accept-charset="utf-8" target="_blank" class="search-form"><input type="text" name="q" maxlength="20" placeholder="Search"/><input type="hidden" name="sitesearch" value="https://ivaneye.com"/></form></div><div class="widget"><div class="widget-title"><i class="fa fa-folder-o"> 分类</i></div><ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/architecture/">architecture</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/book/">book</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/clojure/">clojure</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/code/">code</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/consensus/">consensus</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/designpattern/">designpattern</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/docker/">docker</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/golang/">golang</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/how/">how</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/io/">io</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/jdk/">jdk</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/junit3/">junit3</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/junit4/">junit4</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/jvm/">jvm</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/lighttable/">lighttable</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/luminus/">luminus</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/module/">module</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/mycode/">mycode</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/other/">other</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/scala/">scala</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/think/">think</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/thread/">thread</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/train/">train</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/why/">why</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/xmind/">xmind</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/zookeeper/">zookeeper</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-star-o"> 标签</i></div><div class="tagcloud"><a href="/tags/jvm/" style="font-size: 15px;">jvm</a> <a href="/tags/book/" style="font-size: 15px;">book</a> <a href="/tags/other/" style="font-size: 15px;">other</a> <a href="/tags/随笔/" style="font-size: 15px;">随笔</a> <a href="/tags/review/" style="font-size: 15px;">review</a> <a href="/tags/read/" style="font-size: 15px;">read</a> <a href="/tags/think/" style="font-size: 15px;">think</a> <a href="/tags/concept/" style="font-size: 15px;">concept</a> <a href="/tags/architecture/" style="font-size: 15px;">architecture</a> <a href="/tags/designpattern/" style="font-size: 15px;">designpattern</a> <a href="/tags/java/" style="font-size: 15px;">java</a> <a href="/tags/clojure/" style="font-size: 15px;">clojure</a> <a href="/tags/osgi/" style="font-size: 15px;">osgi</a> <a href="/tags/proxy/" style="font-size: 15px;">proxy</a> <a href="/tags/docker/" style="font-size: 15px;">docker</a> <a href="/tags/golang/" style="font-size: 15px;">golang</a> <a href="/tags/language/" style="font-size: 15px;">language</a> <a href="/tags/graphviz/" style="font-size: 15px;">graphviz</a> <a href="/tags/cdraw/" style="font-size: 15px;">cdraw</a> <a href="/tags/framework/" style="font-size: 15px;">framework</a> <a href="/tags/luminus/" style="font-size: 15px;">luminus</a> <a href="/tags/xmind/" style="font-size: 15px;">xmind</a> <a href="/tags/transactional/" style="font-size: 15px;">transactional</a> <a href="/tags/index/" style="font-size: 15px;">index</a> <a href="/tags/thread/" style="font-size: 15px;">thread</a> <a href="/tags/scala/" style="font-size: 15px;">scala</a> <a href="/tags/opensource/" style="font-size: 15px;">opensource</a> <a href="/tags/jdk/" style="font-size: 15px;">jdk</a> <a href="/tags/junit3/" style="font-size: 15px;">junit3</a> <a href="/tags/junit4/" style="font-size: 15px;">junit4</a> <a href="/tags/lighttable/" style="font-size: 15px;">lighttable</a> <a href="/tags/theme/" style="font-size: 15px;">theme</a> <a href="/tags/how/" style="font-size: 15px;">how</a> <a href="/tags/io/" style="font-size: 15px;">io</a> <a href="/tags/reactor/" style="font-size: 15px;">reactor</a> <a href="/tags/classloader/" style="font-size: 15px;">classloader</a> <a href="/tags/tomcat/" style="font-size: 15px;">tomcat</a> <a href="/tags/jigsaw/" style="font-size: 15px;">jigsaw</a> <a href="/tags/module/" style="font-size: 15px;">module</a> <a href="/tags/why/" style="font-size: 15px;">why</a> <a href="/tags/zookeeper/" style="font-size: 15px;">zookeeper</a> <a href="/tags/consensus/" style="font-size: 15px;">consensus</a> <a href="/tags/paxos/" style="font-size: 15px;">paxos</a></div></div><div class="widget"><div class="widget-title"><i class="fa fa-file-o"> 最新文章</i></div><ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/2016/12/18/iwant.html">散弹枪知识与狙击枪知识</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/11/29/philosophy.html">哲学是个什么鬼?</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/11/27/lunch.html">巴菲特午餐</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/11/21/cost.html">为时间买单</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/11/19/nas.html">Mybooklive修复</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/11/13/vote.html">李狗嗨与美国大选</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/11/06/learn.html">如何高效学习</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/11/01/machine.html">与机器赛跑</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/10/30/salary.html">平均薪酬×××，你拖后腿了吗？</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/10/20/zhihulive.html">评李笑来的知乎live</a></li></ul></div><div class="widget"><div class="comments-title"><i class="fa fa-comment-o"> 最近评论</i></div><div data-num-items="5" data-show-avatars="0" data-show-time="1" data-show-admin="0" data-excerpt-length="32" data-show-title="1" class="ds-recent-comments"></div></div><div class="widget"><div class="widget-title"><i class="fa fa-external-link"> 友情链接</i></div><ul></ul><a href="null" title="null" target="_blank"></a></div></div></div><div class="pure-u-1 pure-u-md-3-4"><div id="footer">© <a href="/." rel="nofollow">思考，执行，表达！.</a> Powered by<a rel="nofollow" target="_blank" href="https://hexo.io"> Hexo.</a><a rel="nofollow" target="_blank" href="https://github.com/tufu9441/maupassant-hexo"> Theme</a> by<a rel="nofollow" target="_blank" href="https://github.com/pagecho"> Cho.</a></div></div></div><a id="rocket" href="#top" class="show"></a><script type="text/javascript" src="/js/totop.js?v=0.0.0" async></script><script type="text/javascript" src="//cdn.bootcss.com/fancybox/2.1.5/jquery.fancybox.pack.js" async></script><script type="text/javascript" src="/js/fancybox.js?v=0.0.0" async></script><link rel="stylesheet" type="text/css" href="/css/jquery.fancybox.css?v=0.0.0"><script>var duoshuoQuery = {short_name:'ivanpig'};
(function() {
    var ds = document.createElement('script');
    ds.type = 'text/javascript';ds.async = true;
    ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
    ds.charset = 'UTF-8';
    (document.getElementsByTagName('head')[0]
        || document.getElementsByTagName('body')[0]).appendChild(ds);
})();
</script><script type="text/javascript" src="/js/codeblock-resizer.js?v=0.0.0"></script><script type="text/javascript" src="/js/smartresize.js?v=0.0.0"></script></div></body></html>